<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/techblog/blog/rss.xml" title="Tech Blogs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/techblog/blog/atom.xml" title="Tech Blogs Atom Feed"><title data-react-helmet="true">Discussion on Docker File and Docker Compose File | Tech Blogs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://saravmani.github.io/techblog/docs/Docker/Docker-File-DockerCompose"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Discussion on Docker File and Docker Compose File | Tech Blogs"><meta data-react-helmet="true" name="description" content="Discussion on Docker File and Docker Compose File"><meta data-react-helmet="true" property="og:description" content="Discussion on Docker File and Docker Compose File"><link data-react-helmet="true" rel="icon" href="/techblog/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://saravmani.github.io/techblog/docs/Docker/Docker-File-DockerCompose"><link data-react-helmet="true" rel="alternate" href="https://saravmani.github.io/techblog/docs/Docker/Docker-File-DockerCompose" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://saravmani.github.io/techblog/docs/Docker/Docker-File-DockerCompose" hreflang="x-default"><link rel="stylesheet" href="/techblog/assets/css/styles.8d002642.css">
<link rel="preload" href="/techblog/assets/js/runtime~main.b37ea262.js" as="script">
<link rel="preload" href="/techblog/assets/js/main.01e0e5f3.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/techblog/"><div class="navbar__logo"><img src="/techblog/img/logo.svg" alt="Software Architecture| Microservices | Parallel Computing | Distributed Applicaitons| .Net | Angular | Javascript | Typescript" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/techblog/img/logo.svg" alt="Software Architecture| Microservices | Parallel Computing | Distributed Applicaitons| .Net | Angular | Javascript | Typescript" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Software Architecture</b></a><a class="navbar__item navbar__link navbar__link--active" href="/techblog/docs/Docker/Docker-Architecture">Tech Blogs</a></div><div class="navbar__items navbar__items--right"><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/techblog/docs/Docker/Docker-Architecture">Docker Container</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/techblog/docs/Docker/Docker-Architecture">Docker Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/techblog/docs/Docker/Docker-File-DockerCompose">Discussion on Docker File and Docker Compose File</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/techblog/docs/Docker/Docker-How-To-Change-Image-Installation-Path">How to change default Docker image installation path / Direcotory on Windows 10</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/techblog/docs/Docker/Containers/Docker-Frequently-Used-Comments">Containers</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/techblog/docs/SoftwareDevelopment/DisAdvantages-Of-Frameworks">Software Development And Techniques</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/techblog/docs/DB/REDIS/Redis-With-Docker-And-Asp-Net-Core">Database and Inmemory Cache</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/techblog/docs/DeveloperTools/ReSharper/Resharper-Usful-Tips">Developer Tools</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/techblog/docs/DotNetCore/EntityFrameworkCORE/Dapper-Vs-EntityFramework">.NET Core</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/techblog/docs/MobileDevelopment/Ionic5/Ionic-lifecycle-events-order">Mobile Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/techblog/docs/Angular/Angular2/MiddleWare/Angular-Http-Interceptor-Middleware">Angular</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/techblog/docs/intro">Useful Docker Commands</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Discussion on Docker File and Docker Compose File</h1></header><h6 class="anchor anchorWithStickyNavbar_y2LR" id="discussion-on-docker-file-and-docker-compose-file-1">Discussion on Docker File and Docker Compose File<a class="hash-link" href="#discussion-on-docker-file-and-docker-compose-file-1" title="Direct link to heading">â€‹</a></h6><h6 class="anchor anchorWithStickyNavbar_y2LR" id="docker-file">Docker File<a class="hash-link" href="#docker-file" title="Direct link to heading">â€‹</a></h6><ul><li>It basically a configuration file. Which contains information about
<em>Dependences, What to do? How to do etc.,</em>. We can say Docker file helps to dockerize a given application</li><li>Mostly It contains 2 parts<ul><li>Building the application</li><li>Run the application</li></ul></li></ul><p>To Orchestrate we need a docker-compose file
Â  - docker-compose.yml
Â  - docker-compose.override.yml
Â  Â  <em>It can contain configuration overrides for existing services or entirely new services. The use case for multiple files is based on the environment we can have multiple override files</em></p><h6 class="anchor anchorWithStickyNavbar_y2LR" id="sample-docker-composeyml-file-for-net-core-webapi-project">Sample docker-compose.yml file for .net core WebApi project<a class="hash-link" href="#sample-docker-composeyml-file-for-net-core-webapi-project" title="Direct link to heading">â€‹</a></h6><div class="codeBlockContainer_J+bg language-ini theme-code-block"><div class="codeBlockContent_csEI ini"><pre tabindex="0" class="prism-code language-ini codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">version: &#x27;3.4&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">services:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  bloggerDocDB:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      image: mongo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  bloggerservice:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      image: ${DOCKER_REGISTRY-}bloggerservice</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      build:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        context: .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        dockerfile: BloggerService/Dockerfile</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">volumes: # it specifies the storage outside of the container. In our case,Â if the container restarts then mongo DB data or other data will get lost.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Â  Â  Â  Â  Â  Â  #if it needs to be persisted we can use volumes. This data will get stored in the hosting machine. Even if the image has removed and recreated this data will be available in the host machine</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  mongo_data:</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h6 class="anchor anchorWithStickyNavbar_y2LR" id="sample-docker-composeoverrideyml-file-for-net-core-webapi-project">Sample docker-compose.override.yml file for .net core webapi project<a class="hash-link" href="#sample-docker-composeoverrideyml-file-for-net-core-webapi-project" title="Direct link to heading">â€‹</a></h6><div class="codeBlockContainer_J+bg language-ini theme-code-block"><div class="codeBlockContent_csEI ini"><pre tabindex="0" class="prism-code language-ini codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">version: &#x27;3.4&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">services:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   bloggerdb:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       container_name: bloggerdb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       restart: always</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       #Always restarts the applicatoin in case of ERROR</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           volumes:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">               - ${WEBAPP_STORAGE_HOME}/SITE:/data/db</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">               # Store the data which is generated by container. It is a permenant storage</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           ports:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              -&quot;27017:27017&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   bloggerservice:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       environment:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         - ASPNETCORE_ENVIRONMENT=Development</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         -&quot;DBSettings:ConnectionString=mongodb://bloggerdb:27017&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         # Note here *bloggerdb* is actually a container name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         # Within docker env. we have to use container name and *Actual* port</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       depends_on:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          - bloggerdb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          # This means the second container WILL NOT wait till the first container started completely. it just says the order</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        volumes:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           - ${HOME}/.microsoft/usersecrets/:/root/.microsoft/usersecrets</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           - ${HOME}/.aspnet/https:/root/.aspnet/https/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       ports:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         - &quot;5000:80&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><blockquote><p><em>Note - Docker environment-specific,  settings can be overridden under <strong>Environment Section</strong></em>Example - In a Normal environment (Without a container), we may connect to other services with local ports. But within the Docker environment, the ports can be different*</p></blockquote><h6 class="anchor anchorWithStickyNavbar_y2LR" id="to-run-and-stop-docker-compose-file">To run and stop Docker compose file<a class="hash-link" href="#to-run-and-stop-docker-compose-file" title="Direct link to heading">â€‹</a></h6><div class="codeBlockContainer_J+bg language-powershell theme-code-block"><div class="codeBlockContent_csEI powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker-compose -f docker-compose.yml  -f docker-compose.override.yml up -d</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># -d to run in background</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Here based on env we can pass the override filename</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker-compose -f docker-compose.yml  -f docker-compose.override.yml down -d</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h6 class="anchor anchorWithStickyNavbar_y2LR" id="to-build-or-rebuild-services">To Build or rebuild services<a class="hash-link" href="#to-build-or-rebuild-services" title="Direct link to heading">â€‹</a></h6><p>If you change Code/Configurations etc then run below command to rebuild.
But docker file updates we no need to call build command.</p><div class="codeBlockContainer_J+bg language-powershell theme-code-block"><div class="codeBlockContent_csEI powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker-compose -f docker-compose.yml  -f docker-compose.override.yml up --build</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Docker/Docker-File-DockerCompose.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/techblog/docs/Docker/Docker-Architecture"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Docker Architecture</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/techblog/docs/Docker/Docker-How-To-Change-Image-Installation-Path"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">How to change default Docker image installation path / Direcotory on Windows 10</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Tech Blogs, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/techblog/assets/js/runtime~main.b37ea262.js"></script>
<script src="/techblog/assets/js/main.01e0e5f3.js"></script>
</body>
</html>